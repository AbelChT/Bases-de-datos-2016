CREATE VIEW tempValidas AS
  SELECT id
  FROM TEMPORADA
  WHERE DIVISION=1 OR DIVISION=2;

CREATE VIEW partidos_jugados AS
  ((SELECT IDTEMP as temp_, EQUIPO_LOCAL AS equip_
  FROM PARTIDO
  WHERE EXISTS(SELECT *
                 FROM tempValidas
                 WHERE idTEMP = id
    ) AND GOLES_LOCAL>=0)

  UNION ALL

   (SELECT IDTEMP as temp_, EQUIPO_VISITANTE AS equip_
  FROM PARTIDO
  WHERE EXISTS(SELECT *
                 FROM tempValidas
                 WHERE idTEMP = id
    ) AND GOLES_VISITANTE>=0));

CREATE VIEW partidos_ganados AS
  ((SELECT idTemp AS temporada_,equipo_local AS equipo_
    FROM partido
    WHERE EXISTS(SELECT *
                 FROM tempValidas
                 WHERE idTEMP = id
    ) AND goles_local>GOLES_VISITANTE)

  UNION ALL

  (SELECT idTemp AS temporada_,equipo_visitante AS equipo_
    FROM partido
    WHERE EXISTS(SELECT *
                 FROM tempValidas
                 WHERE idTEMP = id
    ) AND goles_local<GOLES_VISITANTE));

CREATE VIEW TOTAL_VICTORIAS AS
  SELECT count(*) AS vict ,temporada_,equipo_
  FROM partidos_ganados
  GROUP BY temporada_,equipo_;

CREATE VIEW TOTAL_JUGADOS AS
  SELECT count(*) AS GAME ,temp_,equip_
  FROM partidos_jugados
  GROUP BY temp_,equip_;

CREATE VIEW porcentaje AS
  SELECT 100*(COUNT(TOTAL_VICTORIAS.vict)/COUNT(TOTAL_JUGADOS.GAME)) as porc,temp_,equip_
  FROM TOTAL_VICTORIAS,TOTAL_JUGADOS
  GROUP BY (temp_,equip_);

SELECT *
FROM porcentaje;